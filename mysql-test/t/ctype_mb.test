########################################
##### WL#7554 Force schema `test` to character set latin1
##### This test should be migrated to utf8mb4
--disable_query_log
let $testdbcs140=`select default_character_set_name from information_schema.schemata where schema_name='test'`;
drop schema test;
create schema test character set latin1;
use test;
--enable_query_log
########################################

#
# Test of alter table
#
--disable_warnings
drop table if exists t1;
--enable_warnings

CREATE TABLE t1 SELECT _utf8'test' as c1, _utf8'тест' as c2;
SHOW CREATE TABLE t1;
DELETE FROM t1;
ALTER TABLE t1 ADD c3 CHAR(4) CHARACTER SET utf8;
SHOW CREATE TABLE t1;
INSERT IGNORE INTO t1 VALUES ('aaaabbbbccccdddd','aaaabbbbccccdddd','aaaabbbbccccdddd');
SELECT * FROM t1;
DROP TABLE t1;

CREATE TABLE t1 (a CHAR(4) CHARACTER SET utf8, KEY key_a(a(3)));
SHOW CREATE TABLE t1;
ANALYZE TABLE t1;
SHOW KEYS FROM t1;
ALTER TABLE t1 CHANGE a a CHAR(4);
SHOW CREATE TABLE t1;
ANALYZE TABLE t1;
SHOW KEYS FROM t1;
ALTER TABLE t1 CHANGE a a CHAR(4) CHARACTER SET utf8;
SHOW CREATE TABLE t1;
ANALYZE TABLE t1;
SHOW KEYS FROM t1;
DROP TABLE t1;

# End of 4.1 tests

########################################
##### WL#7554 set schema `test` back to what it was
--disable_query_log
drop schema test;
--eval create schema test character set $testdbcs140;
--enable_query_log
########################################
