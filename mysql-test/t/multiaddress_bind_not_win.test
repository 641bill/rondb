--echo #
--echo # WL#11652 -- Support multiple addresses for the --bind-address command option
--echo #

--source include/check_ipv6.inc
--source include/not_windows.inc

--let $MYSQLD_LOG= $MYSQL_TMP_DIR/server.log
--let $MYSQLD_DATADIR= `SELECT @@datadir`

--echo # Stop DB server which was created by MTR default
--exec echo "wait" > $MYSQLTEST_VARDIR/tmp/mysqld.1.expect
--source include/shutdown_mysqld.inc

--echo # Check that not existing IP address as a value of
--echo # the option --bind-address is treated as an error.
--error 1
--exec $MYSQLD --log-error=$MYSQLD_LOG --datadir=$MYSQLD_DATADIR --no-defaults --secure-file-priv="" --bind-address=128.0.0.1

--let SEARCH_FILE=$MYSQLD_LOG
--let SEARCH_PATTERN= Bind on TCP/IP port: Can't assign requested address
--source include/search_pattern.inc

--remove_file $MYSQLD_LOG

--echo # Check that not existing IP address as one of a value of
--echo # the option --bind-address is treated as an error.
--error 1
--exec $MYSQLD --log-error=$MYSQLD_LOG --datadir=$MYSQLD_DATADIR --no-defaults --secure-file-priv="" --bind-address=128.0.0.1,::1

--let SEARCH_FILE=$MYSQLD_LOG
--let SEARCH_PATTERN= Bind on TCP/IP port: Can't assign requested address
--source include/search_pattern.inc

--remove_file $MYSQLD_LOG

--echo #
--echo # Starting mysqld in the regular mode...
--echo #
--let $restart_parameters =

--source include/start_mysqld.inc
