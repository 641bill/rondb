#
# Bug#33909696 WL#11350 Streaming doesn't happen, when UNION All used at top level
#
CREATE TABLE t(a INT);
CREATE TABLE t1(a INT);
CREATE TABLE r(a INT);
EXPLAIN FORMAT = tree
(SELECT * FROM t UNION SELECT * FROM t1)  UNION ALL (SELECT * FROM r);
EXPLAIN
-> Append
    -> Stream results  (rows=2)
        -> Table scan on <union temporary>  (rows=2)
            -> Union materialize with deduplication  (rows=2)
                -> Table scan on t  (rows=1)
                -> Table scan on t1  (rows=1)
    -> Stream results  (rows=1)
        -> Table scan on r  (rows=1)

EXPLAIN FORMAT = tree
(SELECT * FROM t UNION SELECT * FROM t1)  UNION ALL SELECT * FROM r
UNION ALL SELECT * FROM t;
EXPLAIN
-> Append
    -> Stream results  (rows=2)
        -> Table scan on <union temporary>  (rows=2)
            -> Union materialize with deduplication  (rows=2)
                -> Table scan on t  (rows=1)
                -> Table scan on t1  (rows=1)
    -> Stream results  (rows=1)
        -> Table scan on r  (rows=1)
    -> Stream results  (rows=1)
        -> Table scan on t  (rows=1)

EXPLAIN FORMAT = tree
(SELECT * FROM t UNION SELECT * FROM t1)  UNION ALL SELECT * FROM r
UNION DISTINCT SELECT * FROM t;
EXPLAIN
-> Table scan on <union temporary>  (rows=4)
    -> Union materialize with deduplication  (rows=4)
        -> Table scan on t  (rows=1)
        -> Table scan on t1  (rows=1)
        -> Table scan on r  (rows=1)
        -> Table scan on t  (rows=1)

EXPLAIN FORMAT = tree
(SELECT * FROM t UNION SELECT * FROM t1)  UNION ALL SELECT * FROM r
UNION ALL (SELECT * FROM t UNION DISTINCT SELECT * FROM r);
EXPLAIN
-> Append
    -> Stream results  (rows=2)
        -> Table scan on <union temporary>  (rows=2)
            -> Union materialize with deduplication  (rows=2)
                -> Table scan on t  (rows=1)
                -> Table scan on t1  (rows=1)
    -> Stream results  (rows=1)
        -> Table scan on r  (rows=1)
    -> Stream results  (rows=2)
        -> Table scan on <union temporary>  (rows=2)
            -> Union materialize with deduplication  (rows=2)
                -> Table scan on t  (rows=1)
                -> Table scan on r  (rows=1)

EXPLAIN FORMAT = tree
(SELECT * FROM t UNION SELECT * FROM t1)  UNION ALL SELECT * FROM r
UNION ALL (SELECT * FROM t UNION ALL SELECT * FROM r);
EXPLAIN
-> Append
    -> Stream results  (rows=2)
        -> Table scan on <union temporary>  (rows=2)
            -> Union materialize with deduplication  (rows=2)
                -> Table scan on t  (rows=1)
                -> Table scan on t1  (rows=1)
    -> Stream results  (rows=1)
        -> Table scan on r  (rows=1)
    -> Stream results  (rows=1)
        -> Table scan on t  (rows=1)
    -> Stream results  (rows=1)
        -> Table scan on r  (rows=1)

DROP TABLE t, t1, r;
#
# Verify that INTERSECT is not a reserved word in production builds
#
CREATE TABLE intersect(i int);
DROP TABLE intersect;
SELECT 1 INTERSECT SELECT 2;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SELECT 2' at line 1
SELECT 1 EXCEPT SELECT 2;
ERROR 42000: This version of MySQL doesn't yet support 'EXCEPT'
