create table t1(a int not null, b int, c char(10) not null, d varchar(20)) engine = innodb;
insert into t1 values (5,5,'oo','oo'),(4,4,'tr','tr'),(3,4,'ad','ad'),(2,3,'ak','ak');
commit;
alter table t1 add index b (b), add index b (b);
ERROR 42000: Duplicate key name 'b'
alter table t1 add index (b,b);
ERROR 42S21: Duplicate column name 'b'
alter table t1 add index d2 (d);
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) NOT NULL,
  `d` varchar(20) DEFAULT NULL,
  KEY `d2` (`d`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	d2	23	NULL	4	
select * from t1 order by d;
a	b	c	d
3	4	ad	ad
2	3	ak	ak
5	5	oo	oo
4	4	tr	tr
alter table t1 add unique index (b);
ERROR 23000: Duplicate entry '4' for key 'b'
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) NOT NULL,
  `d` varchar(20) DEFAULT NULL,
  KEY `d2` (`d`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
alter table t1 add index (b);
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) NOT NULL,
  `d` varchar(20) DEFAULT NULL,
  KEY `d2` (`d`),
  KEY `b` (`b`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
alter table t1 add unique index (c), add index (d);
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) NOT NULL,
  `d` varchar(20) DEFAULT NULL,
  UNIQUE KEY `c` (`c`),
  KEY `d2` (`d`),
  KEY `b` (`b`),
  KEY `d` (`d`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	c	10	NULL	4	
drop index c on t1;
ERROR 42000: This table type requires a primary key
alter table t1 add primary key (a), drop index c;
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) NOT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  KEY `d2` (`d`),
  KEY `b` (`b`),
  KEY `d` (`d`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
alter table t1 add primary key (c);
ERROR 42000: Multiple primary key defined
alter table t1 drop primary key, add primary key (b);
ERROR 23000: Duplicate entry '4' for key 'PRIMARY'
create unique index c on t1 (c);
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) NOT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `c` (`c`),
  KEY `d2` (`d`),
  KEY `b` (`b`),
  KEY `d` (`d`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	c	10	NULL	4	
select * from t1 order by c;
a	b	c	d
3	4	ad	ad
2	3	ak	ak
5	5	oo	oo
4	4	tr	tr
alter table t1 drop index b, add index (b);
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) NOT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `c` (`c`),
  KEY `d2` (`d`),
  KEY `d` (`d`),
  KEY `b` (`b`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
insert into t1 values(6,1,'ggg','ggg');
select * from t1;
a	b	c	d
2	3	ak	ak
3	4	ad	ad
4	4	tr	tr
5	5	oo	oo
6	1	ggg	ggg
select * from t1 order by b;
a	b	c	d
6	1	ggg	ggg
2	3	ak	ak
3	4	ad	ad
4	4	tr	tr
5	5	oo	oo
select * from t1 order by c;
a	b	c	d
3	4	ad	ad
2	3	ak	ak
6	1	ggg	ggg
5	5	oo	oo
4	4	tr	tr
select * from t1 order by d;
a	b	c	d
3	4	ad	ad
2	3	ak	ak
6	1	ggg	ggg
5	5	oo	oo
4	4	tr	tr
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	b	5	NULL	5	
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	c	10	NULL	5	
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	d2	23	NULL	5	
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) NOT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `c` (`c`),
  KEY `d2` (`d`),
  KEY `d` (`d`),
  KEY `b` (`b`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
drop table t1;
create table t1(a int not null, b int, c char(10), d varchar(20), primary key (a)) engine = innodb;
insert into t1 values (1,1,'ab','ab'),(2,2,'ac','ac'),(3,3,'ad','ad'),(4,4,'afe','afe');
commit;
alter table t1 add index (c(2));
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  KEY `c` (`c`(2))
) ENGINE=InnoDB DEFAULT CHARSET=latin1
alter table t1 add unique index (d(10));
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `d` (`d`(10)),
  KEY `c` (`c`(2))
) ENGINE=InnoDB DEFAULT CHARSET=latin1
insert into t1 values(5,1,'ggg','ggg');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	3	ad	ad
4	4	afe	afe
5	1	ggg	ggg
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
5	1	ggg	ggg
2	2	ac	ac
3	3	ad	ad
4	4	afe	afe
select * from t1 order by c;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	3	ad	ad
4	4	afe	afe
5	1	ggg	ggg
select * from t1 order by d;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	3	ad	ad
4	4	afe	afe
5	1	ggg	ggg
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `d` (`d`(10)),
  KEY `c` (`c`(2))
) ENGINE=InnoDB DEFAULT CHARSET=latin1
alter table t1 drop index d;
insert into t1 values(8,9,'fff','fff');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	3	ad	ad
4	4	afe	afe
5	1	ggg	ggg
8	9	fff	fff
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
5	1	ggg	ggg
2	2	ac	ac
3	3	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by c;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	3	ad	ad
4	4	afe	afe
8	9	fff	fff
5	1	ggg	ggg
select * from t1 order by d;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	3	ad	ad
4	4	afe	afe
8	9	fff	fff
5	1	ggg	ggg
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	6	Using filesort
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	6	Using filesort
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	6	Using filesort
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  KEY `c` (`c`(2))
) ENGINE=InnoDB DEFAULT CHARSET=latin1
drop table t1;
create table t1(a int not null, b int, c char(10), d varchar(20), primary key (a)) engine = innodb;
insert into t1 values (1,1,'ab','ab'),(2,2,'ac','ac'),(3,2,'ad','ad'),(4,4,'afe','afe');
commit;
alter table t1 add unique index (b,c);
insert into t1 values(8,9,'fff','fff');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by c;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by d;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	b	16	NULL	5	
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `b` (`b`,`c`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
alter table t1 add index (b,c);
insert into t1 values(11,11,'kkk','kkk');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
11	11	kkk	kkk
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
11	11	kkk	kkk
select * from t1 order by c;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
11	11	kkk	kkk
select * from t1 order by d;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
11	11	kkk	kkk
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	b	16	NULL	6	
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	6	Using filesort
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	6	Using filesort
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `b` (`b`,`c`),
  KEY `b_2` (`b`,`c`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
alter table t1 add unique index (c,d);
insert into t1 values(13,13,'yyy','aaa');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
11	11	kkk	kkk
13	13	yyy	aaa
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
11	11	kkk	kkk
13	13	yyy	aaa
select * from t1 order by c;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
11	11	kkk	kkk
13	13	yyy	aaa
select * from t1 order by d;
a	b	c	d
13	13	yyy	aaa
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
11	11	kkk	kkk
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	b	16	NULL	7	
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	c	34	NULL	7	
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	7	Using filesort
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `b` (`b`,`c`),
  UNIQUE KEY `c` (`c`,`d`),
  KEY `b_2` (`b`,`c`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
drop table t1;
create table t1(a int not null, b int not null, c int, primary key (a), key (b)) engine = innodb;
create table t3(a int not null, c int not null, d int, primary key (a), key (c)) engine = innodb;
create table t4(a int not null, d int not null, e int, primary key (a), key (d)) engine = innodb;
create table t2(a int not null, b int not null, c int not null, d int not null, e int,
foreign key (b) references t1(b) on delete cascade,
foreign key (c) references t3(c), foreign key (d) references t4(d))
engine = innodb;
alter table t1 drop index b;
ERROR HY000: Cannot drop index 'b': needed in a foreign key constraint
alter table t3 drop index c;
ERROR HY000: Cannot drop index 'c': needed in a foreign key constraint
alter table t4 drop index d;
ERROR HY000: Cannot drop index 'd': needed in a foreign key constraint
alter table t2 drop index b;
ERROR HY000: Cannot drop index 'b': needed in a foreign key constraint
alter table t2 drop index b, drop index c, drop index d;
ERROR HY000: Cannot drop index 'b': needed in a foreign key constraint
create unique index dc on t2 (d,c);
alter table t2 add primary key (a);
insert into t1 values (1,1,1);
insert into t3 values (1,1,1);
insert into t4 values (1,1,1);
insert into t2 values (1,1,1,1,1);
commit;
alter table t2 drop index b, add index (b);
show create table t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `a` int(11) NOT NULL,
  `b` int(11) NOT NULL,
  `c` int(11) NOT NULL,
  `d` int(11) NOT NULL,
  `e` int(11) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `dc` (`d`,`c`),
  KEY `c` (`c`),
  KEY `b` (`b`),
  CONSTRAINT `t2_ibfk_1` FOREIGN KEY (`b`) REFERENCES `t1` (`b`) ON DELETE CASCADE,
  CONSTRAINT `t2_ibfk_2` FOREIGN KEY (`c`) REFERENCES `t3` (`c`),
  CONSTRAINT `t2_ibfk_3` FOREIGN KEY (`d`) REFERENCES `t4` (`d`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
delete from t1;
select * from t2;
a	b	c	d	e
drop table if exists t2,t1,t3,t4;
create table t1(a int not null, b int, c char(10), d varchar(20), primary key (a)) 
engine = innodb default charset=utf8;
insert into t1 values (1,1,'ab','ab'),(2,2,'ac','ac'),(3,2,'ad','ad'),(4,4,'afe','afe');
commit;
alter table t1 add unique index (b);
ERROR 23000: Duplicate entry '2' for key 'b'
insert into t1 values(8,9,'fff','fff');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by c;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by d;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8
alter table t1 add index (b);
insert into t1 values(10,10,'kkk','iii');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	kkk	iii
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	kkk	iii
select * from t1 order by c;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	kkk	iii
select * from t1 order by d;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	kkk	iii
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	b	5	NULL	6	
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	6	Using filesort
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	6	Using filesort
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  KEY `b` (`b`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8
alter table t1 add unique index (c), add index (d);
insert into t1 values(11,11,'aaa','mmm');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	kkk	iii
11	11	aaa	mmm
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	kkk	iii
11	11	aaa	mmm
select * from t1 order by c;
a	b	c	d
11	11	aaa	mmm
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	kkk	iii
select * from t1 order by d;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	kkk	iii
11	11	aaa	mmm
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	b	5	NULL	7	
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	c	31	NULL	7	
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	d	63	NULL	7	
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `c` (`c`),
  KEY `b` (`b`),
  KEY `d` (`d`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
drop table t1;
create table t1(a int not null, b int, c char(10), d varchar(20), primary key (a)) 
engine = innodb default charset=ucs2;
insert into t1 values (1,1,'ab','ab'),(2,2,'ac','ac'),(3,2,'ad','ad'),(4,4,'afe','afe');
commit;
alter table t1 add unique index (b);
ERROR 23000: Duplicate entry '2' for key 'b'
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`)
) ENGINE=InnoDB DEFAULT CHARSET=ucs2
alter table t1 add index (b);
insert into t1 values(8,9,'fff','fff');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by c;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by d;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	b	5	NULL	5	
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	5	Using filesort
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  KEY `b` (`b`)
) ENGINE=InnoDB DEFAULT CHARSET=ucs2
alter table t1 add unique index (c), add index (d);
insert into t1 values(10,10,'aaa','kkk');
select * from t1;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	aaa	kkk
select * from t1 order by b;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	aaa	kkk
select * from t1 order by c;
a	b	c	d
10	10	aaa	kkk
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
select * from t1 order by d;
a	b	c	d
1	1	ab	ab
2	2	ac	ac
3	2	ad	ad
4	4	afe	afe
8	9	fff	fff
10	10	aaa	kkk
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	b	5	NULL	6	
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	c	21	NULL	6	
explain select * from t1 order by d;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	d	43	NULL	6	
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `c` (`c`),
  KEY `b` (`b`),
  KEY `d` (`d`)
) ENGINE=InnoDB DEFAULT CHARSET=ucs2
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
drop table t1;
create table t1(a int not null, b int) engine = innodb;
insert into t1 values (1,1),(1,1),(1,1),(1,1);
alter table t1 add unique index (a);
ERROR 23000: Duplicate entry '1' for key 'a'
alter table t1 add unique index (b);
ERROR 23000: Duplicate entry '1' for key 'b'
alter table t1 add unique index (a), add unique index(b);
ERROR 23000: Duplicate entry '1' for key 'a'
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1
drop table t1;
create table t1(a int not null, c int not null,b int, primary key(a), unique key(c), key(b)) engine = innodb;
alter table t1 drop index c, drop index b;
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `c` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  PRIMARY KEY (`a`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
drop table t1;
create table t1(a int not null, b int, primary key(a)) engine = innodb;
alter table t1 add index (b);
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  PRIMARY KEY (`a`),
  KEY `b` (`b`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
drop table t1;
create table t1(a int not null, b int, c char(10), d varchar(20), primary key (a)) engine = innodb;
insert into t1 values (1,1,'ab','ab'),(2,2,'ac','ac'),(3,3,'ac','ac'),(4,4,'afe','afe');
alter table t1 add unique index (b), add unique index (c), add unique index (d);
ERROR 23000: Duplicate entry 'ac' for key 'c'
alter table t1 add unique index (b), add index (d), add unique index (c);
ERROR 23000: Duplicate entry 'ac' for key 'c'
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) DEFAULT NULL,
  `c` char(10) DEFAULT NULL,
  `d` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`a`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
drop table t1;
create table t1(a int not null, b int not null, c int, primary key (a), key(c)) engine=innodb;
insert into t1 values (5,1,5),(4,2,4),(3,3,3),(2,4,2),(1,5,1);
alter table t1 add unique index (b);
insert into t1 values (10,20,20),(11,19,19),(12,18,18),(13,17,17);
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) NOT NULL,
  `c` int(11) DEFAULT NULL,
  PRIMARY KEY (`a`),
  UNIQUE KEY `b` (`b`),
  KEY `c` (`c`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
explain select * from t1 order by c;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	c	5	NULL	9	
explain select * from t1 order by a;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	9	
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	b	4	NULL	9	
select * from t1 order by a;
a	b	c
1	5	1
2	4	2
3	3	3
4	2	4
5	1	5
10	20	20
11	19	19
12	18	18
13	17	17
select * from t1 order by b;
a	b	c
5	1	5
4	2	4
3	3	3
2	4	2
1	5	1
13	17	17
12	18	18
11	19	19
10	20	20
select * from t1 order by c;
a	b	c
1	5	1
2	4	2
3	3	3
4	2	4
5	1	5
13	17	17
12	18	18
11	19	19
10	20	20
drop table t1;
create table t1(a int not null, b int not null) engine=innodb;
insert into t1 values (1,1);
alter table t1 add primary key(b);
insert into t1 values (2,2);
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  `b` int(11) NOT NULL,
  PRIMARY KEY (`b`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
select * from t1;
a	b
1	1
2	2
explain select * from t1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	2	
explain select * from t1 order by a;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	2	Using filesort
explain select * from t1 order by b;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	2	
checksum table t1;
Table	Checksum
test.t1	582702641
drop table t1;
create table t1(a int not null) engine=innodb;
insert into t1 values (1);
alter table t1 add primary key(a);
insert into t1 values (2);
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL,
  PRIMARY KEY (`a`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
commit;
select * from t1;
a
1
2
explain select * from t1;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	2	Using index
explain select * from t1 order by a;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	index	NULL	PRIMARY	4	NULL	2	Using index
drop table t1;
create table t1(a int, b blob, c text, d text not null) engine=innodb default charset = utf8;
insert into t1 values (22,repeat('jejdkrun87',220),repeat('jejdkrun87',440),'jejdkrun87');
insert into t1 values (44,repeat('adfd72nh9k',440),repeat('adfd72nh9k',880),'adfd72nh9k');
insert into t1 values (null,null,null,'null');
select count(*) from t1 where a=44;
count(*)
1
select a,b=repeat(d,10*a),c=repeat(d,20*a) from t1;
a	b=repeat(d,10*a)	c=repeat(d,20*a)
22	1	1
44	1	1
NULL	NULL	NULL
select a,length(b),length(c),d from t1;
a	length(b)	length(c)	d
22	2200	4400	jejdkrun87
44	4400	8800	adfd72nh9k
NULL	NULL	NULL	null
alter table t1 add primary key (a), add key (b(20));
ERROR 42000: All parts of a PRIMARY KEY must be NOT NULL; if you need NULL in a key, use UNIQUE instead
delete from t1 where d='null';
alter table t1 add primary key (a), add key (b(20));
select count(*) from t1 where a=44;
count(*)
1
select a,b=repeat(d,10*a),c=repeat(d,20*a) from t1;
a	b=repeat(d,10*a)	c=repeat(d,20*a)
22	1	1
44	1	1
select a,length(b),length(c),d from t1;
a	length(b)	length(c)	d
22	2200	4400	jejdkrun87
44	4400	8800	adfd72nh9k
insert into t1 values (33,repeat('adfdpplkeock',330),repeat('adfdpplkeock',660),'adfdpplkeock');
insert into t1 values (55,repeat('adfdijnmnb78k',550),repeat('adfdijnmnb78k',1100),'adfdijnmnb78k');
insert into t1 values (66,repeat('adfdijn0loKNHJik',660),repeat('adfdijn0loKNHJik',1320),'adfdijn0loKNHJik');
show create table t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` int(11) NOT NULL DEFAULT '0',
  `b` blob,
  `c` text,
  `d` text NOT NULL,
  PRIMARY KEY (`a`),
  KEY `b` (`b`(20))
) ENGINE=InnoDB DEFAULT CHARSET=utf8
check table t1;
Table	Op	Msg_type	Msg_text
test.t1	check	status	OK
explain select * from t1 where b like 'adfd%';
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	range	b	b	23	NULL	2	Using where
select a,b=repeat(d,10*a),c=repeat(d,20*a) from t1;
a	b=repeat(d,10*a)	c=repeat(d,20*a)
22	1	1
33	1	1
44	1	1
55	1	1
66	1	1
select a,length(b),length(c),d from t1;
a	length(b)	length(c)	d
22	2200	4400	jejdkrun87
33	3960	7920	adfdpplkeock
44	4400	8800	adfd72nh9k
55	7150	14300	adfdijnmnb78k
66	10560	21120	adfdijn0loKNHJik
drop table t1;
