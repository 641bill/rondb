-- source include/have_ndb.inc
-- source have_ndb_fk.inc

create table product (
  category int not null,
  id int not null,
  price decimal,
  primary key(category, id))
engine=ndb;

create table customer (
  id int not null,
  primary key (id))
engine=ndb;

create table product_order (
  no int not null auto_increment,
  product_category int not null,
  product_id int not null,
  customer_id int not null,
  primary key(no),
  index (product_category, product_id),
  foreign key (product_category, product_id) references product(category, id)
    on update cascade on delete restrict,
  index (customer_id),
  foreign key (customer_id) references customer(id))
engine=ndb;

select *
from information_schema.table_constraints
where table_schema = 'test'
order by table_name, constraint_name;

drop table product, customer, product_order;
