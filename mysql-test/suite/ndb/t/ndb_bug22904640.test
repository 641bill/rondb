-- source include/have_ndb.inc

--disable_warnings
DROP TABLE IF EXISTS t1;
--enable_warnings

CREATE TABLE t1 (a int, b int, c int, PRIMARY KEY(a,b))
  ENGINE = NDB
  PARTITION BY KEY (a);

insert into t1 values 
       (1,1,3),(1,2,3),(1,3,3),(1,4,3),(1,5,3),(1,6,3),
       (1,7,3),(1,8,3),(1,9,3),(1,10,3),(1,11,3),(1,12,3);

select * from t1 order by b;

--let $ndb_desc_opts= -pb -dtest t1
--source suite/ndb/include/ndb_desc_print.inc

--source include/ndb_backup.inc
drop table t1;
--exec $NDB_RESTORE --no-defaults -b $the_backup_id -n 1 -m -r --print --print_meta $NDB_BACKUPS-$the_backup_id >> $NDB_TOOLS_OUTPUT
--exec $NDB_RESTORE --no-defaults -b $the_backup_id -n 2 -r --print --print_meta $NDB_BACKUPS-$the_backup_id >> $NDB_TOOLS_OUTPUT

--let $ndb_desc_opts= -pb -dtest t1
--source suite/ndb/include/ndb_desc_print.inc

select * from t1 order by b;

# Trigger assert from bug#22904640 with an alter table
# not actually doing any changes to partitioniong
ALTER ONLINE TABLE t1 REORGANIZE PARTITION;

DROP TABLE t1;

