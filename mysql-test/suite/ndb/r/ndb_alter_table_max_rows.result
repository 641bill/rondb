# Setup table t1
CREATE TABLE t1(
a INT PRIMARY KEY,
b VARCHAR(255),
c DATETIME,
KEY(b),
INDEX(a,b,c)
)
ENGINE=ndb;
INSERT INTO t1 VALUES
(1,'1','2015-03-01 00:00:01'),
(2,'1','2015-03-02 00:00:02'),
(3,'1','2015-03-03 00:00:03'),
(4,'1','2015-03-04 00:00:04'),
(5,'1','2015-03-05 00:00:05');
ALTER TABLE t1
algorithm=copy,
max_rows=33333 /* Small enough to get default number of frags */;
ALTER TABLE t1
algorithm=inplace,
max_rows=33332 /* Small enough to still be at default number of frags */;
ALTER TABLE t1
algorithm=inplace,
max_rows=0 /* Back to zero without changing number of frags */;
Note! The value of MAX_ROWS in NDB is still 33333
No such object: t1


NDBT_ProgramExit: 0 - OK

ALTER ONLINE TABLE t1
reorganize partition;
Warnings:
Warning	1287	'ONLINE' is deprecated and will be removed in a future release. Please use ALGORITHM=INPLACE instead
INSERT INTO t1 VALUES(37, "MySQL Cluster", '2015-12-15');
SELECT b FROM t1 WHERE a > 10;
b
MySQL Cluster
DELETE FROM t1 WHERE a = 37;
ALTER TABLE t1
algorithm=copy,
max_rows=444444444 /* Large with many frags */;
ALTER TABLE t1
algorithm=inplace,
max_rows=0 /* Not allowed since number of frags reduced */;
ERROR 0A000: ALGORITHM=INPLACE is not supported for this operation. Try ALGORITHM=COPY.
ALTER TABLE t1
algorithm=copy,
max_rows=0 /* Back to zero by using copying */;
ALTER ONLINE TABLE t1
reorganize partition;
Warnings:
Warning	1287	'ONLINE' is deprecated and will be removed in a future release. Please use ALGORITHM=INPLACE instead
INSERT INTO t1 VALUES(37, "MySQL Cluster", '2015-12-15');
SELECT b FROM t1 WHERE a > 10;
b
MySQL Cluster
DELETE FROM t1 WHERE a = 37;
#Cleanup
DROP TABLE t1;
