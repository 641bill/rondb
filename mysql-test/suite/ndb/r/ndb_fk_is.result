create table product (
category int not null,
id int not null,
price decimal,
primary key(category, id))
engine=ndb;
create table customer (
id int not null,
primary key (id))
engine=ndb;
create table product_order (
no int not null auto_increment,
product_category int not null,
product_id int not null,
customer_id int not null,
primary key(no),
index (product_category, product_id),
foreign key (product_category, product_id) references product(category, id)
on update restrict on delete cascade,
index (customer_id),
foreign key (customer_id) references customer(id))
engine=ndb;
select *
from information_schema.table_constraints
where table_schema = 'test'
order by table_name, constraint_name;
CONSTRAINT_CATALOG	CONSTRAINT_SCHEMA	CONSTRAINT_NAME	TABLE_SCHEMA	TABLE_NAME	CONSTRAINT_TYPE
def	test	FK_12_17	test	customer	FOREIGN KEY
def	test	PRIMARY	test	customer	PRIMARY KEY
def	test	FK_10_16	test	product	FOREIGN KEY
def	test	PRIMARY	test	product	PRIMARY KEY
def	test	FK_10_16	test	product_order	FOREIGN KEY
def	test	FK_12_17	test	product_order	FOREIGN KEY
def	test	PRIMARY	test	product_order	PRIMARY KEY
drop table product, customer, product_order;
