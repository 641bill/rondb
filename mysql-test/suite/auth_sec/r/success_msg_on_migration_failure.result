#
# Bug#28330922 - KEYRING MIGRATION FAILS, BUT SAYS "KEYRING MIGRATION
#                SUCCESSFULL" + EMPTY FILE
#
# Restart mysql server with keyring_file plugin
# restart:--early-plugin-load=keyring_file.so --keyring-file-data=MYSQL_TMP_DIR/dir1/key1 --plugin-dir=KEYRING_PLUGIN_PATH
# Generate the key
CREATE DATABASE bug28330922;
USE bug28330922;
CREATE TABLE t1(c1 INT) ENGINE = InnoDB ENCRYPTION="Y";
# Migrate the key
Pattern "\[ERROR\] \[[^]]*\] \[[^]]*\] Plugin 'keyring_file' init function returned error." found
Pattern "\[ERROR\] \[[^]]*\] \[[^]]*\] Keyring migration failed" found
Pattern "\[ERROR\] \[[^]]*\] \[[^]]*\] Aborting" found
# Cleanup
DROP DATABASE bug28330922;
